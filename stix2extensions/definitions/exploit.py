from stix2 import CustomObject
from stix2.properties import (
    ReferenceProperty,
    StringProperty,
)

from stix2extensions.automodel.automodel import auto_model, extend_property

_type = "exploit"


@auto_model
@CustomObject(
    _type,
    [
        (
            "name",
            extend_property(
                StringProperty(required=True),
                description="Human-readable name of the exploit",
                examples=["CVE-2023-12345 Remote Code Execution"],
            ),
        ),
        (
            "description",
            extend_property(
                StringProperty(),
                description="Detailed description of the exploit and its impact",
                examples=[
                    "Buffer overflow in X component allowing remote code execution"
                ],
            ),
        ),
        (
            "vulnerability_ref",
            extend_property(
                ReferenceProperty(valid_types="vulnerability", spec_version="2.1"),
                description="Defines the STIX ID for the vulnerability object this exploit is related to",
                examples=["vulnerability--c5dcf0f3-4afe-4458-b79b-0b3e671db8ed"],
            ),
        ),
        (
            "exploit_type",
            extend_property(
                StringProperty(),
                description="Category or class of the exploit",
                examples=[
                    "client-side",
                    "remote-code-execution",
                    "privilege-escalation",
                    "information-disclosure",
                ],
            ),
        ),
        (
            "proof_of_concept",
            extend_property(
                StringProperty(),
                description="Reference or link to a proof-of-concept for the exploit",
                examples=[
                    "https://github.com/example/exploit-poc",
                    "git@github.com:dogesec/CVE-0000-00000-Proof-Of-Concept.git",
                ],
            ),
        ),
    ],
)
class Exploit(object):
    pass
