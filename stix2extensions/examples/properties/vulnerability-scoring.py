import uuid
from uuid import UUID

from stix2 import Vulnerability
from stix2extensions.definitions.properties import (
    VulnerabilityScoringExtension,
)

vulnerability_scoring_ExtensionDefinitionSMO = (
    VulnerabilityScoringExtension.extension_definition
)

namespace = UUID("1abb62b9-e513-5f55-8e73-8f6d7b55c237")

created_by_ref = "identity--" + str(uuid.uuid5(namespace, f"dogesec-demo"))
created = "2020-01-01T00:00:00.000Z"
modified = "2020-01-01T00:00:00.000Z"

example_VulnerabilitySDO = Vulnerability(
    id="vulnerability--" + str(uuid.uuid5(namespace, f"example_VulnerabilitySDO")),
    created_by_ref=created_by_ref,
    created=created,
    modified=modified,
    name="CVE-XXX-XXXX",
    external_references=[
        {
            "source_name": "cve",
            "url": "https://nvd.nist.gov/vuln/detail/CVE-XXX-XXXX",
            "external_id": "CVE-XXX-XXXX",
        }
    ],
    object_marking_refs=[
        "marking-definition--94868c89-83c2-464b-929b-a1a8aa3c8487",
        "marking-definition--" + str(uuid.uuid5(namespace, f"stix2extensions")),
    ],
    x_cvss={
        "v3_1": [
            {
                "vector_string": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N",
                "exploitability_score": 1.7,
                "impact_score": 2.7,
                "base_score": 4.8,
                "base_severity": "MEDIUM",
                "source": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
                "type": "Primary",
            },
            {
                "vector_string": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N",
                "exploitability_score": 1.5,
                "impact_score": 4.4,
                "base_score": 2.3,
                "base_severity": "MEDIUM",
                "source": "test@test.com",
                "type": "Secondary",
            },
        ],
        "v2_0": [
            {
                "vector_string": "AV:N/AC:L/Au:N/C:P/I:P/A:P",
                "exploitability_score": 1.7,
                "impact_score": 2.7,
                "base_score": 4.8,
                "base_severity": "MEDIUM",
                "source": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
                "type": "Secondary",
            }
        ],
    },
    extensions={
        vulnerability_scoring_ExtensionDefinitionSMO.id: {
            "extension_type": "toplevel-property-extension"
        }
    },
)

examples = [
    example_VulnerabilitySDO,
]
