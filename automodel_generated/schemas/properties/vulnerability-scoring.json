{
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "allOf": [
        {
            "$ref": "https://github.com/oasis-open/cti-stix2-json-schemas/raw/refs/heads/master/schemas/sdos/vulnerability.json"
        },
        {
            "properties": {
                "x_cvss": {
                    "$ref": "#/$defs/FullCVSSProperty",
                    "title": "X Cvss"
                },
                "extensions": {
                    "additionalProperties": {
                        "type": "object"
                    },
                    "properties": {
                        "extension-definition--2c5c13af-ee92-5246-9ba7-0b958f8cd34a": {
                            "const": {
                                "extension_type": "toplevel-property-extension"
                            },
                            "type": "object"
                        }
                    },
                    "required": [
                        "extension-definition--2c5c13af-ee92-5246-9ba7-0b958f8cd34a"
                    ],
                    "type": "object"
                }
            }
        }
    ],
    "description": "This extension adds new properties to Vulnerability SDOs to provide scoring.",
    "required": [
        "extensions"
    ],
    "title": "vulnerability-scoring",
    "type": "object",
    "$defs": {
        "CVSSv2Property": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "properties": {
                "vector_string": {
                    "description": "CVSS v2 vector string",
                    "examples": [
                        "AV:N/AC:L/Au:N/C:P/I:P/A:P"
                    ],
                    "title": "Vector String",
                    "type": "string"
                },
                "exploitability_score": {
                    "description": "The Exploitability Score",
                    "examples": [
                        8.5
                    ],
                    "maximum": 10,
                    "minimum": 0,
                    "title": "Exploitability Score",
                    "type": "number"
                },
                "impact_score": {
                    "description": "The Impact Score",
                    "examples": [
                        8.5
                    ],
                    "maximum": 10,
                    "minimum": 0,
                    "title": "Impact Score",
                    "type": "number"
                },
                "base_score": {
                    "description": "The Base Score",
                    "examples": [
                        8.5
                    ],
                    "maximum": 10,
                    "minimum": 0,
                    "title": "Base Score",
                    "type": "number"
                },
                "base_severity": {
                    "description": "CVSS v2 Base Severity.",
                    "enum": [
                        "NONE",
                        "LOW",
                        "MEDIUM",
                        "HIGH"
                    ],
                    "title": "Base Severity",
                    "type": "string"
                },
                "source": {
                    "description": "The source of the analysis. This is usually a CNA.",
                    "examples": [
                        "134c704f-9b21-4f2e-91b3-4a467353bcc0"
                    ],
                    "title": "Source",
                    "type": "string"
                },
                "type": {
                    "description": "The type of analysis.",
                    "examples": [
                        "Primary"
                    ],
                    "title": "Type",
                    "type": "string"
                }
            },
            "required": [
                "vector_string",
                "type"
            ],
            "title": "CVSSv2Property",
            "type": "object"
        },
        "CVSSv31Property": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "properties": {
                "vector_string": {
                    "description": "The CVSS v3.1 vector string",
                    "examples": [
                        "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
                    ],
                    "title": "Vector String",
                    "type": "string"
                },
                "exploitability_score": {
                    "description": "The Exploitability Score",
                    "examples": [
                        8.5
                    ],
                    "maximum": 10,
                    "minimum": 0,
                    "title": "Exploitability Score",
                    "type": "number"
                },
                "impact_score": {
                    "description": "The Impact Score",
                    "examples": [
                        8.5
                    ],
                    "maximum": 10,
                    "minimum": 0,
                    "title": "Impact Score",
                    "type": "number"
                },
                "base_score": {
                    "description": "The Base Score",
                    "examples": [
                        8.5
                    ],
                    "maximum": 10,
                    "minimum": 0,
                    "title": "Base Score",
                    "type": "number"
                },
                "base_severity": {
                    "description": "CVSS v3.1 Base Severity.",
                    "enum": [
                        "NONE",
                        "LOW",
                        "MEDIUM",
                        "HIGH",
                        "CRITICAL"
                    ],
                    "title": "Base Severity",
                    "type": "string"
                },
                "source": {
                    "description": "The source of the analysis. This is usually a CNA.",
                    "examples": [
                        "134c704f-9b21-4f2e-91b3-4a467353bcc0"
                    ],
                    "title": "Source",
                    "type": "string"
                },
                "type": {
                    "description": "The type of analysis.",
                    "examples": [
                        "Primary"
                    ],
                    "title": "Type",
                    "type": "string"
                }
            },
            "required": [
                "vector_string",
                "type"
            ],
            "title": "CVSSv31Property",
            "type": "object"
        },
        "CVSSv3Property": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "properties": {
                "vector_string": {
                    "description": "The CVSS v3.0 vector string",
                    "examples": [
                        "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
                    ],
                    "title": "Vector String",
                    "type": "string"
                },
                "exploitability_score": {
                    "description": "The Exploitability Score",
                    "examples": [
                        8.5
                    ],
                    "maximum": 10,
                    "minimum": 0,
                    "title": "Exploitability Score",
                    "type": "number"
                },
                "impact_score": {
                    "description": "The Impact Score",
                    "examples": [
                        8.5
                    ],
                    "maximum": 10,
                    "minimum": 0,
                    "title": "Impact Score",
                    "type": "number"
                },
                "base_score": {
                    "description": "The Base Score",
                    "examples": [
                        8.5
                    ],
                    "maximum": 10,
                    "minimum": 0,
                    "title": "Base Score",
                    "type": "number"
                },
                "base_severity": {
                    "description": "CVSS v3.0 Base Severity.",
                    "enum": [
                        "NONE",
                        "LOW",
                        "MEDIUM",
                        "HIGH",
                        "CRITICAL"
                    ],
                    "title": "Base Severity",
                    "type": "string"
                },
                "source": {
                    "description": "The source of the analysis. This is usually a CNA.",
                    "examples": [
                        "134c704f-9b21-4f2e-91b3-4a467353bcc0"
                    ],
                    "title": "Source",
                    "type": "string"
                },
                "type": {
                    "description": "The type of analysis.",
                    "examples": [
                        "Primary"
                    ],
                    "title": "Type",
                    "type": "string"
                }
            },
            "required": [
                "vector_string",
                "type"
            ],
            "title": "CVSSv3Property",
            "type": "object"
        },
        "CVSSv4Property": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "properties": {
                "vector_string": {
                    "description": "The CVSS v4.0 vector string",
                    "examples": [
                        "CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:L/VI:L/VA:L/SC:N/SI:N/SA:N/E:P/CR:X/IR:X/AR:X/MAV:X/MAC:X/MAT:X/MPR:X/MUI:X/MVC:X/MVI:X/MVA:X/MSC:X/MSI:X/MSA:X/S:X/AU:X/R:X/V:X/RE:X/U:X"
                    ],
                    "title": "Vector String",
                    "type": "string"
                },
                "base_score": {
                    "description": "The Base Score",
                    "examples": [
                        8.5
                    ],
                    "maximum": 10,
                    "minimum": 0,
                    "title": "Base Score",
                    "type": "number"
                },
                "base_severity": {
                    "description": "CVSS v4.0 Base Severity.",
                    "enum": [
                        "NONE",
                        "LOW",
                        "MEDIUM",
                        "HIGH",
                        "CRITICAL"
                    ],
                    "title": "Base Severity",
                    "type": "string"
                },
                "source": {
                    "description": "The source of the analysis. This is usually a CNA.",
                    "examples": [
                        "134c704f-9b21-4f2e-91b3-4a467353bcc0"
                    ],
                    "title": "Source",
                    "type": "string"
                },
                "type": {
                    "description": "The type of analysis.",
                    "examples": [
                        "Primary"
                    ],
                    "title": "Type",
                    "type": "string"
                }
            },
            "required": [
                "vector_string",
                "type"
            ],
            "title": "CVSSv4Property",
            "type": "object"
        },
        "FullCVSSProperty": {
            "$schema": "https://json-schema.org/draft/2020-12/schema",
            "properties": {
                "v2_0": {
                    "items": {
                        "$ref": "#/$defs/CVSSv2Property"
                    },
                    "title": "V2 0",
                    "type": "array"
                },
                "v3_0": {
                    "items": {
                        "$ref": "#/$defs/CVSSv3Property"
                    },
                    "title": "V3 0",
                    "type": "array"
                },
                "v3_1": {
                    "items": {
                        "$ref": "#/$defs/CVSSv31Property"
                    },
                    "title": "V3 1",
                    "type": "array"
                },
                "v4_0": {
                    "items": {
                        "$ref": "#/$defs/CVSSv4Property"
                    },
                    "title": "V4 0",
                    "type": "array"
                }
            },
            "title": "FullCVSSProperty",
            "type": "object"
        }
    }
}