{
	"$id": "https://raw.githubusercontent.com/muchdogesec/stix2extensions/main/schemas/properties/indicator-vulnerable-cpes.json",
	"$schema": "https://json-schema.org/draft/2020-12/schema",
	"title": "indicator-vulnerable-cpes",
	"description": "This extension adds new properties to Indicator SDOs to list CPE vulnerable inside a pattern.",
	"type": "object",
	"allOf": [
		{
			"$ref": "https://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/master/schemas/sdos/indicator.json"
		},
		{
			"properties": {
				"extensions": {
					"type": "object",
					"properties": {
						"extension-definition--ad995824-2901-5f6e-890b-561130a239d4": {
							"type": "object",
							"properties": {
								"extension_type": {
									"enum": [
										"toplevel-property-extension"
									]
								}
							},
							"required": ["extension_type"]
						}
					},
					"required": ["extension-definition--ad995824-2901-5f6e-890b-561130a239d4"]
				},
				"x_cpes": {
					"type": "array",
					"minItems": 1,
					"items": {
						"type": "object",
						"properties": {
							"vulnerable": {
								"type": "object",
								"properties": {
									"criteria": {
										"type": "string",
										"description": "The criteria for the vulnerable CPE",
										"examples": ["cpe:2.3:a:dell:powerscale_onefs:9.1.0:*:*:*:*:*:*:*"]
									},
									"matchCriteriaId": {
										"type": "string",
										"description": "The matchCriteriaId for the vulnerable CPE",
										"examples": ["68291D44-DBE1-4923-A848-04E64288DC23"]
									}
								}
							},
							"not_vulnerable": {
								"type": "object",
								"properties": {
									"criteria": {
										"type": "string",
										"description": "The criteria for the not vulnerable CPE",
										"examples": ["cpe:2.3:a:campcodes:gym_management_system:1.0:*:*:*:*:*:*:*"]
									},
									"matchCriteriaId": {
										"type": "string",
										"description": "The matchCriteriaId for the not vulnerable CPE",
										"examples": ["D6B26946-8BCC-4A6E-95D3-FC3E42A7754F"]
									}
								}
							}
						}
					}
				}
			}
		}
	]
}